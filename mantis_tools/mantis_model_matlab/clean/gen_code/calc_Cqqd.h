#include <eigen3/Eigen/Dense>

inline void calc_Cqqd(Eigen::MatrixXd& Cqqd, double IJ1x, double IJ1y, double IJ1z, double IJ2x, double IJ2y, double IJ2z, double bvx, double bvy, double bvz, double bw1, double bw2, double bw3, double l0, double l1, double l2, double m1, double m2, double r1, double r1d, double r2, double r2d) {
	Cqqd(0,0) = -r1d*(IJ2x*cos(r1+r2)*sin(r1+r2)-IJ2y*cos(r1+r2)*sin(r1+r2)+IJ1x*cos(r1)*sin(r1)-IJ1y*cos(r1)*sin(r1))-r2d*(IJ2x*cos(r1+r2)*sin(r1+r2)-IJ2y*cos(r1+r2)*sin(r1+r2));
	Cqqd(2,0) = r1d*(IJ2x*cos(r1*2.0+r2*2.0)*(1.0/2.0)-IJ2y*cos(r1*2.0+r2*2.0)*(1.0/2.0)+IJ1x*cos(r1*2.0)*(1.0/2.0)-IJ1y*cos(r1*2.0)*(1.0/2.0))+r2d*(IJ2x*cos(r1*2.0+r2*2.0)*(1.0/2.0)-IJ2y*cos(r1*2.0+r2*2.0)*(1.0/2.0));
	Cqqd(4,0) = r2d*(IJ2y*cos(r1+r2)*(l2*(1.0/2.0)+l0*sin(r1+r2)+l1*cos(r2))*(1.0/2.0)-IJ2x*cos(r1+r2)*(l0*sin(r1+r2)+l1*cos(r2))*(1.0/2.0)-IJ2x*sin(r1+r2)*(l0*cos(r1+r2)-l1*sin(r2))*(1.0/2.0)+IJ2y*sin(r1+r2)*(l0*cos(r1+r2)-l1*sin(r2))*(1.0/2.0))+r1d*(IJ1y*cos(r1)*(l1*(1.0/2.0)+l0*sin(r1))*(1.0/2.0)+IJ2y*cos(r1+r2)*(l2*(1.0/2.0)+l0*sin(r1+r2)+l1*cos(r2))*(1.0/2.0)-IJ2x*sin(r1+r2)*(l0*cos(r1+r2)-l1*sin(r2))*(1.0/2.0)-IJ2x*l0*cos(r1+r2)*sin(r1+r2)*(1.0/2.0)+IJ2y*l0*cos(r1+r2)*sin(r1+r2)*(1.0/2.0)-IJ1x*l0*cos(r1)*sin(r1)+IJ1y*l0*cos(r1)*sin(r1)*(1.0/2.0));
	Cqqd(6,0) = -bvy*(IJ1y*cos(r1)*(l1*(1.0/2.0)+l0*sin(r1))*(1.0/2.0)+IJ2y*cos(r1+r2)*(l2*(1.0/2.0)+l0*sin(r1+r2)+l1*cos(r2))*(1.0/2.0)-IJ2x*sin(r1+r2)*(l0*cos(r1+r2)-l1*sin(r2))*(1.0/2.0)-IJ2x*l0*cos(r1+r2)*sin(r1+r2)*(1.0/2.0)+IJ2y*l0*cos(r1+r2)*sin(r1+r2)*(1.0/2.0)-IJ1x*l0*cos(r1)*sin(r1)+IJ1y*l0*cos(r1)*sin(r1)*(1.0/2.0))+bw1*(IJ2x*cos(r1+r2)*sin(r1+r2)-IJ2y*cos(r1+r2)*sin(r1+r2)+IJ1x*cos(r1)*sin(r1)-IJ1y*cos(r1)*sin(r1))-bw3*(IJ2x*cos(r1*2.0+r2*2.0)*(1.0/2.0)-IJ2y*cos(r1*2.0+r2*2.0)*(1.0/2.0)+IJ1x*cos(r1*2.0)*(1.0/2.0)-IJ1y*cos(r1*2.0)*(1.0/2.0));
	Cqqd(7,0) = bw1*(IJ2x*cos(r1+r2)*sin(r1+r2)-IJ2y*cos(r1+r2)*sin(r1+r2))-bw3*(IJ2x*cos(r1*2.0+r2*2.0)*(1.0/2.0)-IJ2y*cos(r1*2.0+r2*2.0)*(1.0/2.0))-bvy*(IJ2y*cos(r1+r2)*(l2*(1.0/2.0)+l0*sin(r1+r2)+l1*cos(r2))*(1.0/2.0)-IJ2x*cos(r1+r2)*(l0*sin(r1+r2)+l1*cos(r2))*(1.0/2.0)-IJ2x*sin(r1+r2)*(l0*cos(r1+r2)-l1*sin(r2))*(1.0/2.0)+IJ2y*sin(r1+r2)*(l0*cos(r1+r2)-l1*sin(r2))*(1.0/2.0));
	Cqqd(3,1) = -r1d*(IJ2z*(l2*cos(r1+r2)*(1.0/2.0)+l1*cos(r1))*(1.0/2.0)+IJ1z*l1*cos(r1)*(1.0/4.0))-IJ2z*l2*r2d*cos(r1+r2)*(1.0/4.0);
	Cqqd(5,1) = -r1d*(IJ2z*(l2*sin(r1+r2)*(1.0/2.0)+l1*sin(r1))*(1.0/2.0)+IJ1z*l1*sin(r1)*(1.0/4.0))-IJ2z*l2*r2d*sin(r1+r2)*(1.0/4.0);
	Cqqd(6,1) = bvx*(IJ2z*(l2*cos(r1+r2)*(1.0/2.0)+l1*cos(r1))*(1.0/2.0)+IJ1z*l1*cos(r1)*(1.0/4.0))+bvz*(IJ2z*(l2*sin(r1+r2)*(1.0/2.0)+l1*sin(r1))*(1.0/2.0)+IJ1z*l1*sin(r1)*(1.0/4.0));
	Cqqd(7,1) = IJ2z*bvx*l2*cos(r1+r2)*(1.0/4.0)+IJ2z*bvz*l2*sin(r1+r2)*(1.0/4.0);
	Cqqd(0,2) = r1d*(IJ2x*cos(r1*2.0+r2*2.0)*(1.0/2.0)-IJ2y*cos(r1*2.0+r2*2.0)*(1.0/2.0)+IJ1x*cos(r1*2.0)*(1.0/2.0)-IJ1y*cos(r1*2.0)*(1.0/2.0))+r2d*(IJ2x*cos(r1*2.0+r2*2.0)*(1.0/2.0)-IJ2y*cos(r1*2.0+r2*2.0)*(1.0/2.0));
	Cqqd(2,2) = r1d*(IJ2x*cos(r1+r2)*sin(r1+r2)-IJ2y*cos(r1+r2)*sin(r1+r2)+IJ1x*cos(r1)*sin(r1)-IJ1y*cos(r1)*sin(r1))+r2d*(IJ2x*cos(r1+r2)*sin(r1+r2)-IJ2y*cos(r1+r2)*sin(r1+r2));
	Cqqd(4,2) = -r1d*(IJ2y*l0*pow(cos(r1+r2),2.0)*(1.0/2.0)+IJ2x*l0*pow(sin(r1+r2),2.0)*(1.0/2.0)-IJ1x*l0*pow(cos(r1),2.0)*(1.0/2.0)+IJ1y*l0*pow(cos(r1),2.0)*(1.0/2.0)+IJ1x*l0*pow(sin(r1),2.0)*(1.0/2.0)-IJ1y*sin(r1)*(l1*(1.0/2.0)+l0*sin(r1))*(1.0/2.0)-IJ2y*sin(r1+r2)*(l2*(1.0/2.0)+l0*sin(r1+r2)+l1*cos(r2))*(1.0/2.0)-IJ2x*cos(r1+r2)*(l0*cos(r1+r2)-l1*sin(r2))*(1.0/2.0))+r2d*(IJ2y*sin(r1+r2)*(l2*(1.0/2.0)+l0*sin(r1+r2)+l1*cos(r2))*(1.0/2.0)+IJ2x*cos(r1+r2)*(l0*cos(r1+r2)-l1*sin(r2))*(1.0/2.0)-IJ2y*cos(r1+r2)*(l0*cos(r1+r2)-l1*sin(r2))*(1.0/2.0)-IJ2x*sin(r1+r2)*(l0*sin(r1+r2)+l1*cos(r2))*(1.0/2.0));
	Cqqd(6,2) = bvy*(IJ2y*l0*pow(cos(r1+r2),2.0)*(1.0/2.0)+IJ2x*l0*pow(sin(r1+r2),2.0)*(1.0/2.0)-IJ1x*l0*pow(cos(r1),2.0)*(1.0/2.0)+IJ1y*l0*pow(cos(r1),2.0)*(1.0/2.0)+IJ1x*l0*pow(sin(r1),2.0)*(1.0/2.0)-IJ1y*sin(r1)*(l1*(1.0/2.0)+l0*sin(r1))*(1.0/2.0)-IJ2y*sin(r1+r2)*(l2*(1.0/2.0)+l0*sin(r1+r2)+l1*cos(r2))*(1.0/2.0)-IJ2x*cos(r1+r2)*(l0*cos(r1+r2)-l1*sin(r2))*(1.0/2.0))-bw3*(IJ2x*cos(r1+r2)*sin(r1+r2)-IJ2y*cos(r1+r2)*sin(r1+r2)+IJ1x*cos(r1)*sin(r1)-IJ1y*cos(r1)*sin(r1))-bw1*(IJ2x*cos(r1*2.0+r2*2.0)*(1.0/2.0)-IJ2y*cos(r1*2.0+r2*2.0)*(1.0/2.0)+IJ1x*cos(r1*2.0)*(1.0/2.0)-IJ1y*cos(r1*2.0)*(1.0/2.0));
	Cqqd(7,2) = -bw3*(IJ2x*cos(r1+r2)*sin(r1+r2)-IJ2y*cos(r1+r2)*sin(r1+r2))-bw1*(IJ2x*cos(r1*2.0+r2*2.0)*(1.0/2.0)-IJ2y*cos(r1*2.0+r2*2.0)*(1.0/2.0))-bvy*(IJ2y*sin(r1+r2)*(l2*(1.0/2.0)+l0*sin(r1+r2)+l1*cos(r2))*(1.0/2.0)+IJ2x*cos(r1+r2)*(l0*cos(r1+r2)-l1*sin(r2))*(1.0/2.0)-IJ2y*cos(r1+r2)*(l0*cos(r1+r2)-l1*sin(r2))*(1.0/2.0)-IJ2x*sin(r1+r2)*(l0*sin(r1+r2)+l1*cos(r2))*(1.0/2.0));
	Cqqd(1,3) = -r1d*(IJ2z*(l2*cos(r1+r2)*(1.0/2.0)+l1*cos(r1))*(1.0/2.0)+IJ1z*l1*cos(r1)*(1.0/4.0))-IJ2z*l2*r2d*cos(r1+r2)*(1.0/4.0);
	Cqqd(3,3) = r1d*(IJ2z*(l2*cos(r1+r2)*(1.0/2.0)+l1*cos(r1))*(l0+l2*sin(r1+r2)*(1.0/2.0)+l1*sin(r1))+IJ1z*l1*cos(r1)*(l0+l1*sin(r1)*(1.0/2.0))*(1.0/2.0))+IJ2z*l2*r2d*cos(r1+r2)*(l0+l2*sin(r1+r2)*(1.0/2.0)+l1*sin(r1))*(1.0/2.0);
	Cqqd(5,3) = -r1d*(IJ2z*pow(l2*cos(r1+r2)*(1.0/2.0)+l1*cos(r1),2.0)*(1.0/2.0)-IJ2z*(l2*sin(r1+r2)*(1.0/2.0)+l1*sin(r1))*(l0+l2*sin(r1+r2)*(1.0/2.0)+l1*sin(r1))*(1.0/2.0)+IJ1z*(l1*l1)*pow(cos(r1),2.0)*(1.0/8.0)-IJ1z*l1*sin(r1)*(l0+l1*sin(r1)*(1.0/2.0))*(1.0/4.0))-r2d*(IJ2z*l2*cos(r1+r2)*(l2*cos(r1+r2)*(1.0/2.0)+l1*cos(r1))*(1.0/4.0)-IJ2z*l2*sin(r1+r2)*(l0+l2*sin(r1+r2)*(1.0/2.0)+l1*sin(r1))*(1.0/4.0));
	Cqqd(6,3) = -r2d*(IJ2z*(l2*cos(r1+r2)*(1.0/2.0)+l1*cos(r1))*(1.0/2.0)-IJ2z*l2*cos(r1+r2)*(1.0/4.0))+bw2*(IJ2z*(l2*cos(r1+r2)*(1.0/2.0)+l1*cos(r1))*(1.0/2.0)+IJ1z*l1*cos(r1)*(1.0/4.0))-bvx*(IJ2z*(l2*cos(r1+r2)*(1.0/2.0)+l1*cos(r1))*(l0+l2*sin(r1+r2)*(1.0/2.0)+l1*sin(r1))+IJ1z*l1*cos(r1)*(l0+l1*sin(r1)*(1.0/2.0))*(1.0/2.0))+bvz*(IJ2z*pow(l2*cos(r1+r2)*(1.0/2.0)+l1*cos(r1),2.0)*(1.0/2.0)-IJ2z*(l2*sin(r1+r2)*(1.0/2.0)+l1*sin(r1))*(l0+l2*sin(r1+r2)*(1.0/2.0)+l1*sin(r1))*(1.0/2.0)+IJ1z*(l1*l1)*pow(cos(r1),2.0)*(1.0/8.0)-IJ1z*l1*sin(r1)*(l0+l1*sin(r1)*(1.0/2.0))*(1.0/4.0));
	Cqqd(7,3) = r1d*(IJ2z*(l2*cos(r1+r2)*(1.0/2.0)+l1*cos(r1))*(1.0/2.0)-IJ2z*l2*cos(r1+r2)*(1.0/4.0))+bvz*(IJ2z*l2*cos(r1+r2)*(l2*cos(r1+r2)*(1.0/2.0)+l1*cos(r1))*(1.0/4.0)-IJ2z*l2*sin(r1+r2)*(l0+l2*sin(r1+r2)*(1.0/2.0)+l1*sin(r1))*(1.0/4.0))+IJ2z*bw2*l2*cos(r1+r2)*(1.0/4.0)-IJ2z*bvx*l2*cos(r1+r2)*(l0+l2*sin(r1+r2)*(1.0/2.0)+l1*sin(r1))*(1.0/2.0);
	Cqqd(0,4) = r2d*(IJ2y*cos(r1+r2)*(l2*(1.0/2.0)+l0*sin(r1+r2)+l1*cos(r2))*(1.0/2.0)-IJ2x*cos(r1+r2)*(l0*sin(r1+r2)+l1*cos(r2))*(1.0/2.0)-IJ2x*sin(r1+r2)*(l0*cos(r1+r2)-l1*sin(r2))*(1.0/2.0)+IJ2y*sin(r1+r2)*(l0*cos(r1+r2)-l1*sin(r2))*(1.0/2.0))+r1d*(IJ1y*cos(r1)*(l1*(1.0/2.0)+l0*sin(r1))*(1.0/2.0)+IJ2y*cos(r1+r2)*(l2*(1.0/2.0)+l0*sin(r1+r2)+l1*cos(r2))*(1.0/2.0)-IJ2x*sin(r1+r2)*(l0*cos(r1+r2)-l1*sin(r2))*(1.0/2.0)-IJ2x*l0*cos(r1+r2)*sin(r1+r2)*(1.0/2.0)+IJ2y*l0*cos(r1+r2)*sin(r1+r2)*(1.0/2.0)-IJ1x*l0*cos(r1)*sin(r1)+IJ1y*l0*cos(r1)*sin(r1)*(1.0/2.0));
	Cqqd(2,4) = -r1d*(IJ2y*l0*pow(cos(r1+r2),2.0)*(1.0/2.0)+IJ2x*l0*pow(sin(r1+r2),2.0)*(1.0/2.0)-IJ1x*l0*pow(cos(r1),2.0)*(1.0/2.0)+IJ1y*l0*pow(cos(r1),2.0)*(1.0/2.0)+IJ1x*l0*pow(sin(r1),2.0)*(1.0/2.0)-IJ1y*sin(r1)*(l1*(1.0/2.0)+l0*sin(r1))*(1.0/2.0)-IJ2y*sin(r1+r2)*(l2*(1.0/2.0)+l0*sin(r1+r2)+l1*cos(r2))*(1.0/2.0)-IJ2x*cos(r1+r2)*(l0*cos(r1+r2)-l1*sin(r2))*(1.0/2.0))+r2d*(IJ2y*sin(r1+r2)*(l2*(1.0/2.0)+l0*sin(r1+r2)+l1*cos(r2))*(1.0/2.0)+IJ2x*cos(r1+r2)*(l0*cos(r1+r2)-l1*sin(r2))*(1.0/2.0)-IJ2y*cos(r1+r2)*(l0*cos(r1+r2)-l1*sin(r2))*(1.0/2.0)-IJ2x*sin(r1+r2)*(l0*sin(r1+r2)+l1*cos(r2))*(1.0/2.0));
	Cqqd(4,4) = -r1d*(IJ1x*(l0*l0)*cos(r1)*sin(r1)+IJ2x*l0*sin(r1+r2)*(l0*cos(r1+r2)-l1*sin(r2))-IJ1y*l0*cos(r1)*(l1+l0*sin(r1)*2.0)*(1.0/2.0)-IJ2y*l0*cos(r1+r2)*(l2+l0*sin(r1+r2)*2.0+l1*cos(r2)*2.0)*(1.0/2.0))+r2d*(IJ2y*(l0*cos(r1+r2)*2.0-l1*sin(r2)*2.0)*(l2+l0*sin(r1+r2)*2.0+l1*cos(r2)*2.0)*(1.0/4.0)-IJ2x*(l0*sin(r1+r2)+l1*cos(r2))*(l0*cos(r1+r2)-l1*sin(r2)));
	Cqqd(6,4) = bw3*(IJ2y*l0*pow(cos(r1+r2),2.0)*(1.0/2.0)+IJ2x*l0*pow(sin(r1+r2),2.0)*(1.0/2.0)-IJ1x*l0*pow(cos(r1),2.0)*(1.0/2.0)+IJ1y*l0*pow(cos(r1),2.0)*(1.0/2.0)+IJ1x*l0*pow(sin(r1),2.0)*(1.0/2.0)-IJ1y*sin(r1)*(l1*(1.0/2.0)+l0*sin(r1))*(1.0/2.0)-IJ2y*sin(r1+r2)*(l2*(1.0/2.0)+l0*sin(r1+r2)+l1*cos(r2))*(1.0/2.0)-IJ2x*cos(r1+r2)*(l0*cos(r1+r2)-l1*sin(r2))*(1.0/2.0))-bw1*(IJ1y*cos(r1)*(l1*(1.0/2.0)+l0*sin(r1))*(1.0/2.0)+IJ2y*cos(r1+r2)*(l2*(1.0/2.0)+l0*sin(r1+r2)+l1*cos(r2))*(1.0/2.0)-IJ2x*sin(r1+r2)*(l0*cos(r1+r2)-l1*sin(r2))*(1.0/2.0)-IJ2x*l0*cos(r1+r2)*sin(r1+r2)*(1.0/2.0)+IJ2y*l0*cos(r1+r2)*sin(r1+r2)*(1.0/2.0)-IJ1x*l0*cos(r1)*sin(r1)+IJ1y*l0*cos(r1)*sin(r1)*(1.0/2.0))+bvy*(IJ1x*(l0*l0)*cos(r1)*sin(r1)+IJ2x*l0*sin(r1+r2)*(l0*cos(r1+r2)-l1*sin(r2))-IJ1y*l0*cos(r1)*(l1+l0*sin(r1)*2.0)*(1.0/2.0)-IJ2y*l0*cos(r1+r2)*(l2+l0*sin(r1+r2)*2.0+l1*cos(r2)*2.0)*(1.0/2.0));
	Cqqd(7,4) = -bw1*(IJ2y*cos(r1+r2)*(l2*(1.0/2.0)+l0*sin(r1+r2)+l1*cos(r2))*(1.0/2.0)-IJ2x*cos(r1+r2)*(l0*sin(r1+r2)+l1*cos(r2))*(1.0/2.0)-IJ2x*sin(r1+r2)*(l0*cos(r1+r2)-l1*sin(r2))*(1.0/2.0)+IJ2y*sin(r1+r2)*(l0*cos(r1+r2)-l1*sin(r2))*(1.0/2.0))-bw3*(IJ2y*sin(r1+r2)*(l2*(1.0/2.0)+l0*sin(r1+r2)+l1*cos(r2))*(1.0/2.0)+IJ2x*cos(r1+r2)*(l0*cos(r1+r2)-l1*sin(r2))*(1.0/2.0)-IJ2y*cos(r1+r2)*(l0*cos(r1+r2)-l1*sin(r2))*(1.0/2.0)-IJ2x*sin(r1+r2)*(l0*sin(r1+r2)+l1*cos(r2))*(1.0/2.0))-bvy*(IJ2y*(l0*cos(r1+r2)*2.0-l1*sin(r2)*2.0)*(l2+l0*sin(r1+r2)*2.0+l1*cos(r2)*2.0)*(1.0/4.0)-IJ2x*(l0*sin(r1+r2)+l1*cos(r2))*(l0*cos(r1+r2)-l1*sin(r2)));
	Cqqd(1,5) = -r1d*(IJ2z*(l2*sin(r1+r2)*(1.0/2.0)+l1*sin(r1))*(1.0/2.0)+IJ1z*l1*sin(r1)*(1.0/4.0))-IJ2z*l2*r2d*sin(r1+r2)*(1.0/4.0);
	Cqqd(3,5) = -r1d*(IJ2z*pow(l2*cos(r1+r2)*(1.0/2.0)+l1*cos(r1),2.0)*(1.0/2.0)-IJ2z*(l2*sin(r1+r2)*(1.0/2.0)+l1*sin(r1))*(l0+l2*sin(r1+r2)*(1.0/2.0)+l1*sin(r1))*(1.0/2.0)+IJ1z*(l1*l1)*pow(cos(r1),2.0)*(1.0/8.0)-IJ1z*l1*sin(r1)*(l0+l1*sin(r1)*(1.0/2.0))*(1.0/4.0))-r2d*(IJ2z*l2*cos(r1+r2)*(l2*cos(r1+r2)*(1.0/2.0)+l1*cos(r1))*(1.0/4.0)-IJ2z*l2*sin(r1+r2)*(l0+l2*sin(r1+r2)*(1.0/2.0)+l1*sin(r1))*(1.0/4.0));
	Cqqd(5,5) = -r1d*(IJ2z*(l2*cos(r1+r2)*(1.0/2.0)+l1*cos(r1))*(l2*sin(r1+r2)*(1.0/2.0)+l1*sin(r1))+IJ1z*(l1*l1)*cos(r1)*sin(r1)*(1.0/4.0))-IJ2z*l2*r2d*sin(r1+r2)*(l2*cos(r1+r2)*(1.0/2.0)+l1*cos(r1))*(1.0/2.0);
	Cqqd(6,5) = -r2d*(IJ2z*(l2*sin(r1+r2)*(1.0/2.0)+l1*sin(r1))*(1.0/2.0)-IJ2z*l2*sin(r1+r2)*(1.0/4.0))+bw2*(IJ2z*(l2*sin(r1+r2)*(1.0/2.0)+l1*sin(r1))*(1.0/2.0)+IJ1z*l1*sin(r1)*(1.0/4.0))+bvx*(IJ2z*pow(l2*cos(r1+r2)*(1.0/2.0)+l1*cos(r1),2.0)*(1.0/2.0)-IJ2z*(l2*sin(r1+r2)*(1.0/2.0)+l1*sin(r1))*(l0+l2*sin(r1+r2)*(1.0/2.0)+l1*sin(r1))*(1.0/2.0)+IJ1z*(l1*l1)*pow(cos(r1),2.0)*(1.0/8.0)-IJ1z*l1*sin(r1)*(l0+l1*sin(r1)*(1.0/2.0))*(1.0/4.0))+bvz*(IJ2z*(l2*cos(r1+r2)*(1.0/2.0)+l1*cos(r1))*(l2*sin(r1+r2)*(1.0/2.0)+l1*sin(r1))+IJ1z*(l1*l1)*cos(r1)*sin(r1)*(1.0/4.0));
	Cqqd(7,5) = bvx*(IJ2z*l2*cos(r1+r2)*(l2*cos(r1+r2)*(1.0/2.0)+l1*cos(r1))*(1.0/4.0)-IJ2z*l2*sin(r1+r2)*(l0+l2*sin(r1+r2)*(1.0/2.0)+l1*sin(r1))*(1.0/4.0))+r1d*(IJ2z*(l2*sin(r1+r2)*(1.0/2.0)+l1*sin(r1))*(1.0/2.0)-IJ2z*l2*sin(r1+r2)*(1.0/4.0))+IJ2z*bw2*l2*sin(r1+r2)*(1.0/4.0)+IJ2z*bvz*l2*sin(r1+r2)*(l2*cos(r1+r2)*(1.0/2.0)+l1*cos(r1))*(1.0/2.0);
	Cqqd(0,6) = bvy*(IJ1y*cos(r1)*(l1*(1.0/2.0)+l0*sin(r1))*(1.0/2.0)+IJ2y*cos(r1+r2)*(l2*(1.0/2.0)+l0*sin(r1+r2)+l1*cos(r2))*(1.0/2.0)-IJ2x*sin(r1+r2)*(l0*cos(r1+r2)-l1*sin(r2))*(1.0/2.0)-IJ2x*l0*cos(r1+r2)*sin(r1+r2)*(1.0/2.0)+IJ2y*l0*cos(r1+r2)*sin(r1+r2)*(1.0/2.0)-IJ1x*l0*cos(r1)*sin(r1)+IJ1y*l0*cos(r1)*sin(r1)*(1.0/2.0))-bw1*(IJ2x*cos(r1+r2)*sin(r1+r2)-IJ2y*cos(r1+r2)*sin(r1+r2)+IJ1x*cos(r1)*sin(r1)-IJ1y*cos(r1)*sin(r1))+bw3*(IJ2x*cos(r1*2.0+r2*2.0)*(1.0/2.0)-IJ2y*cos(r1*2.0+r2*2.0)*(1.0/2.0)+IJ1x*cos(r1*2.0)*(1.0/2.0)-IJ1y*cos(r1*2.0)*(1.0/2.0));
	Cqqd(1,6) = -bvx*(IJ2z*(l2*cos(r1+r2)*(1.0/2.0)+l1*cos(r1))*(1.0/2.0)+IJ1z*l1*cos(r1)*(1.0/4.0))-bvz*(IJ2z*(l2*sin(r1+r2)*(1.0/2.0)+l1*sin(r1))*(1.0/2.0)+IJ1z*l1*sin(r1)*(1.0/4.0));
	Cqqd(2,6) = -bvy*(IJ2y*l0*pow(cos(r1+r2),2.0)*(1.0/2.0)+IJ2x*l0*pow(sin(r1+r2),2.0)*(1.0/2.0)-IJ1x*l0*pow(cos(r1),2.0)*(1.0/2.0)+IJ1y*l0*pow(cos(r1),2.0)*(1.0/2.0)+IJ1x*l0*pow(sin(r1),2.0)*(1.0/2.0)-IJ1y*sin(r1)*(l1*(1.0/2.0)+l0*sin(r1))*(1.0/2.0)-IJ2y*sin(r1+r2)*(l2*(1.0/2.0)+l0*sin(r1+r2)+l1*cos(r2))*(1.0/2.0)-IJ2x*cos(r1+r2)*(l0*cos(r1+r2)-l1*sin(r2))*(1.0/2.0))+bw3*(IJ2x*cos(r1+r2)*sin(r1+r2)-IJ2y*cos(r1+r2)*sin(r1+r2)+IJ1x*cos(r1)*sin(r1)-IJ1y*cos(r1)*sin(r1))+bw1*(IJ2x*cos(r1*2.0+r2*2.0)*(1.0/2.0)-IJ2y*cos(r1*2.0+r2*2.0)*(1.0/2.0)+IJ1x*cos(r1*2.0)*(1.0/2.0)-IJ1y*cos(r1*2.0)*(1.0/2.0));
	Cqqd(3,6) = -bw2*(IJ2z*(l2*cos(r1+r2)*(1.0/2.0)+l1*cos(r1))*(1.0/2.0)+IJ1z*l1*cos(r1)*(1.0/4.0))+bvx*(IJ2z*(l2*cos(r1+r2)*(1.0/2.0)+l1*cos(r1))*(l0+l2*sin(r1+r2)*(1.0/2.0)+l1*sin(r1))+IJ1z*l1*cos(r1)*(l0+l1*sin(r1)*(1.0/2.0))*(1.0/2.0))-r1d*(l1*m1*cos(r1)*(1.0/2.0)+l1*m2*cos(r1)-IJ2z*l2*cos(r1+r2)*(1.0/2.0)+l2*m2*cos(r1+r2)*(1.0/2.0)-IJ1z*l1*cos(r1)*(1.0/2.0)-IJ2z*l1*cos(r1))+r2d*(IJ2z*(l2*cos(r1+r2)*(1.0/2.0)+l1*cos(r1))*(1.0/2.0)+IJ2z*l2*cos(r1+r2)*(1.0/4.0)-l2*m2*cos(r1+r2)*(1.0/2.0))-bvz*(IJ2z*pow(l2*cos(r1+r2)*(1.0/2.0)+l1*cos(r1),2.0)*(1.0/2.0)-IJ2z*(l2*sin(r1+r2)*(1.0/2.0)+l1*sin(r1))*(l0+l2*sin(r1+r2)*(1.0/2.0)+l1*sin(r1))*(1.0/2.0)+IJ1z*(l1*l1)*pow(cos(r1),2.0)*(1.0/8.0)-IJ1z*l1*sin(r1)*(l0+l1*sin(r1)*(1.0/2.0))*(1.0/4.0));
	Cqqd(4,6) = -bw3*(IJ2y*l0*pow(cos(r1+r2),2.0)*(1.0/2.0)+IJ2x*l0*pow(sin(r1+r2),2.0)*(1.0/2.0)-IJ1x*l0*pow(cos(r1),2.0)*(1.0/2.0)+IJ1y*l0*pow(cos(r1),2.0)*(1.0/2.0)+IJ1x*l0*pow(sin(r1),2.0)*(1.0/2.0)-IJ1y*sin(r1)*(l1*(1.0/2.0)+l0*sin(r1))*(1.0/2.0)-IJ2y*sin(r1+r2)*(l2*(1.0/2.0)+l0*sin(r1+r2)+l1*cos(r2))*(1.0/2.0)-IJ2x*cos(r1+r2)*(l0*cos(r1+r2)-l1*sin(r2))*(1.0/2.0))+bw1*(IJ1y*cos(r1)*(l1*(1.0/2.0)+l0*sin(r1))*(1.0/2.0)+IJ2y*cos(r1+r2)*(l2*(1.0/2.0)+l0*sin(r1+r2)+l1*cos(r2))*(1.0/2.0)-IJ2x*sin(r1+r2)*(l0*cos(r1+r2)-l1*sin(r2))*(1.0/2.0)-IJ2x*l0*cos(r1+r2)*sin(r1+r2)*(1.0/2.0)+IJ2y*l0*cos(r1+r2)*sin(r1+r2)*(1.0/2.0)-IJ1x*l0*cos(r1)*sin(r1)+IJ1y*l0*cos(r1)*sin(r1)*(1.0/2.0))-bvy*(IJ1x*(l0*l0)*cos(r1)*sin(r1)+IJ2x*l0*sin(r1+r2)*(l0*cos(r1+r2)-l1*sin(r2))-IJ1y*l0*cos(r1)*(l1+l0*sin(r1)*2.0)*(1.0/2.0)-IJ2y*l0*cos(r1+r2)*(l2+l0*sin(r1+r2)*2.0+l1*cos(r2)*2.0)*(1.0/2.0));
	Cqqd(5,6) = -r1d*(l1*m1*sin(r1)*(1.0/2.0)+l1*m2*sin(r1)-IJ2z*l2*sin(r1+r2)*(1.0/2.0)+l2*m2*sin(r1+r2)*(1.0/2.0)-IJ1z*l1*sin(r1)*(1.0/2.0)-IJ2z*l1*sin(r1))+r2d*(IJ2z*(l2*sin(r1+r2)*(1.0/2.0)+l1*sin(r1))*(1.0/2.0)+IJ2z*l2*sin(r1+r2)*(1.0/4.0)-l2*m2*sin(r1+r2)*(1.0/2.0))-bw2*(IJ2z*(l2*sin(r1+r2)*(1.0/2.0)+l1*sin(r1))*(1.0/2.0)+IJ1z*l1*sin(r1)*(1.0/4.0))-bvx*(IJ2z*pow(l2*cos(r1+r2)*(1.0/2.0)+l1*cos(r1),2.0)*(1.0/2.0)-IJ2z*(l2*sin(r1+r2)*(1.0/2.0)+l1*sin(r1))*(l0+l2*sin(r1+r2)*(1.0/2.0)+l1*sin(r1))*(1.0/2.0)+IJ1z*(l1*l1)*pow(cos(r1),2.0)*(1.0/8.0)-IJ1z*l1*sin(r1)*(l0+l1*sin(r1)*(1.0/2.0))*(1.0/4.0))-bvz*(IJ2z*(l2*cos(r1+r2)*(1.0/2.0)+l1*cos(r1))*(l2*sin(r1+r2)*(1.0/2.0)+l1*sin(r1))+IJ1z*(l1*l1)*cos(r1)*sin(r1)*(1.0/4.0));
	Cqqd(6,6) = l1*l2*m2*r2d*sin(r2)*(-1.0/2.0);
	Cqqd(7,6) = bvz*(IJ2z*(l2*sin(r1+r2)*(1.0/2.0)+l1*sin(r1))*(1.0/2.0)-IJ2z*l2*sin(r1+r2)*(1.0/4.0))+bvx*(IJ2z*(l2*cos(r1+r2)*(1.0/2.0)+l1*cos(r1))*(1.0/2.0)-IJ2z*l2*cos(r1+r2)*(1.0/4.0))+l1*l2*m2*r1d*sin(r2)*(1.0/2.0);
	Cqqd(0,7) = -bw1*(IJ2x*cos(r1+r2)*sin(r1+r2)-IJ2y*cos(r1+r2)*sin(r1+r2))+bw3*(IJ2x*cos(r1*2.0+r2*2.0)*(1.0/2.0)-IJ2y*cos(r1*2.0+r2*2.0)*(1.0/2.0))+bvy*(IJ2y*cos(r1+r2)*(l2*(1.0/2.0)+l0*sin(r1+r2)+l1*cos(r2))*(1.0/2.0)-IJ2x*cos(r1+r2)*(l0*sin(r1+r2)+l1*cos(r2))*(1.0/2.0)-IJ2x*sin(r1+r2)*(l0*cos(r1+r2)-l1*sin(r2))*(1.0/2.0)+IJ2y*sin(r1+r2)*(l0*cos(r1+r2)-l1*sin(r2))*(1.0/2.0));
	Cqqd(1,7) = IJ2z*bvx*l2*cos(r1+r2)*(-1.0/4.0)-IJ2z*bvz*l2*sin(r1+r2)*(1.0/4.0);
	Cqqd(2,7) = bw3*(IJ2x*cos(r1+r2)*sin(r1+r2)-IJ2y*cos(r1+r2)*sin(r1+r2))+bw1*(IJ2x*cos(r1*2.0+r2*2.0)*(1.0/2.0)-IJ2y*cos(r1*2.0+r2*2.0)*(1.0/2.0))+bvy*(IJ2y*sin(r1+r2)*(l2*(1.0/2.0)+l0*sin(r1+r2)+l1*cos(r2))*(1.0/2.0)+IJ2x*cos(r1+r2)*(l0*cos(r1+r2)-l1*sin(r2))*(1.0/2.0)-IJ2y*cos(r1+r2)*(l0*cos(r1+r2)-l1*sin(r2))*(1.0/2.0)-IJ2x*sin(r1+r2)*(l0*sin(r1+r2)+l1*cos(r2))*(1.0/2.0));
	Cqqd(3,7) = -bvz*(IJ2z*l2*cos(r1+r2)*(l2*cos(r1+r2)*(1.0/2.0)+l1*cos(r1))*(1.0/4.0)-IJ2z*l2*sin(r1+r2)*(l0+l2*sin(r1+r2)*(1.0/2.0)+l1*sin(r1))*(1.0/4.0))+r2d*(IJ2z*l2*cos(r1+r2)*(1.0/2.0)-l2*m2*cos(r1+r2)*(1.0/2.0))+r1d*(IJ2z*(l2*cos(r1+r2)*(1.0/2.0)+l1*cos(r1))*(1.0/2.0)+IJ2z*l2*cos(r1+r2)*(1.0/4.0)-l2*m2*cos(r1+r2)*(1.0/2.0))-IJ2z*bw2*l2*cos(r1+r2)*(1.0/4.0)+IJ2z*bvx*l2*cos(r1+r2)*(l0+l2*sin(r1+r2)*(1.0/2.0)+l1*sin(r1))*(1.0/2.0);
	Cqqd(4,7) = bw1*(IJ2y*cos(r1+r2)*(l2*(1.0/2.0)+l0*sin(r1+r2)+l1*cos(r2))*(1.0/2.0)-IJ2x*cos(r1+r2)*(l0*sin(r1+r2)+l1*cos(r2))*(1.0/2.0)-IJ2x*sin(r1+r2)*(l0*cos(r1+r2)-l1*sin(r2))*(1.0/2.0)+IJ2y*sin(r1+r2)*(l0*cos(r1+r2)-l1*sin(r2))*(1.0/2.0))+bw3*(IJ2y*sin(r1+r2)*(l2*(1.0/2.0)+l0*sin(r1+r2)+l1*cos(r2))*(1.0/2.0)+IJ2x*cos(r1+r2)*(l0*cos(r1+r2)-l1*sin(r2))*(1.0/2.0)-IJ2y*cos(r1+r2)*(l0*cos(r1+r2)-l1*sin(r2))*(1.0/2.0)-IJ2x*sin(r1+r2)*(l0*sin(r1+r2)+l1*cos(r2))*(1.0/2.0))+bvy*(IJ2y*(l0*cos(r1+r2)*2.0-l1*sin(r2)*2.0)*(l2+l0*sin(r1+r2)*2.0+l1*cos(r2)*2.0)*(1.0/4.0)-IJ2x*(l0*sin(r1+r2)+l1*cos(r2))*(l0*cos(r1+r2)-l1*sin(r2)));
	Cqqd(5,7) = -bvx*(IJ2z*l2*cos(r1+r2)*(l2*cos(r1+r2)*(1.0/2.0)+l1*cos(r1))*(1.0/4.0)-IJ2z*l2*sin(r1+r2)*(l0+l2*sin(r1+r2)*(1.0/2.0)+l1*sin(r1))*(1.0/4.0))+r1d*(IJ2z*(l2*sin(r1+r2)*(1.0/2.0)+l1*sin(r1))*(1.0/2.0)+IJ2z*l2*sin(r1+r2)*(1.0/4.0)-l2*m2*sin(r1+r2)*(1.0/2.0))+r2d*(IJ2z*l2*sin(r1+r2)*(1.0/2.0)-l2*m2*sin(r1+r2)*(1.0/2.0))-IJ2z*bw2*l2*sin(r1+r2)*(1.0/4.0)-IJ2z*bvz*l2*sin(r1+r2)*(l2*cos(r1+r2)*(1.0/2.0)+l1*cos(r1))*(1.0/2.0);
	Cqqd(6,7) = -bvz*(IJ2z*(l2*sin(r1+r2)*(1.0/2.0)+l1*sin(r1))*(1.0/2.0)-IJ2z*l2*sin(r1+r2)*(1.0/4.0))-bvx*(IJ2z*(l2*cos(r1+r2)*(1.0/2.0)+l1*cos(r1))*(1.0/2.0)-IJ2z*l2*cos(r1+r2)*(1.0/4.0))-l1*l2*m2*r1d*sin(r2)*(1.0/2.0)-l1*l2*m2*r2d*sin(r2)*(1.0/2.0);
}
